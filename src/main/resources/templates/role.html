<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">

<head th:replace="~{fragments/head}"></head>

<body>

	<head th:replace="~{fragments/header}"></head>

	<head th:replace="~{fragments/menu}"></head>

	<main class="main-wrapper">
		<div class="main-content">
			<!--breadcrumb-->
			<div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
				<div class="breadcrumb-title pe-3">Role</div>
				<div class="ps-3">
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb mb-0 p-0">
							<li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt"></i></a>
							</li>
							<li class="breadcrumb-item active" aria-current="page">Role</li>
						</ol>
					</nav>
				</div>
				<div class="ms-auto">
					<div class="btn-group">
						<button type="button" data-bs-toggle="modal" data-bs-target="#FormModal"
							class="btn btn-primary px-4"><i class="bi bi-plus-lg me-2"></i>Add Role</button>
						<div class="modal fade" id="FormModal">
							<div class="modal-dialog modal-dialog-centered">
								<div class="modal-content">
									<div class="modal-header border-bottom-0 py-2 bg-grd-info">
										<h5 class="modal-title">Add New Role</h5>
										<a href="javascript:;" class="primaery-menu-close" data-bs-dismiss="modal">
											<i class="material-icons-outlined">close</i>
										</a>
									</div>
									<div class="modal-body">
										<div class="form-body">
											<form class="row g-3"  th:action="@{/addRole}" method="post">

												<div class="col-md-12">
													<label for="input3" class="form-label">Role Name</label>
													<input type="text" class="form-control" id="role" name="name" 
														placeholder="Enter Role Name ...">
												</div>

												<div class="col-md-12">
													<div class="d-md-flex d-grid align-items-center gap-3">
														<button type="submit"
															class="btn btn-grd btn-grd-primary px-5">Submit</button>

													</div>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!--end breadcrumb-->

			<div class="row">
				<div class="col-12 col-lg-12">
					<div class="card">
						<div class="card-body p-4">
							<!-- Message Section -->
							<div th:if="${message}" class="alert alert-success" role="alert">
								<p th:text="${message}"></p>
							</div>

							<form class="row g-3" th:action="@{/addRolePermission}" method="post">
								<h5 class="mb-4">Role Form</h5>
								<div class="row mb-3">
									<label for="input35" class="col-sm-3 col-form-label">Role Name</label>
									<div class="col-sm-9">
										<select class="form-select" id="input40" name="role" required>
											<option selected disabled value="">Select</option>
											<th:block th:each="role : ${roles}">
												<option th:value="${role.name}" th:text="${role.name}">
												</option>
											</th:block>
										</select>
									</div>


								</div>

								<div class="row mb-3">
									<label for="input35" class="col-sm-3 col-form-label">Permission Name</label>
									<div class="col-sm-9">
										<select class="form-select" id="input40" name="permission" required>
											<option selected disabled value="">Select</option>
											<th:block th:each="permission : ${permissions}">
												<option th:value="${permission.name}" th:text="${permission.name}">
												</option>
											</th:block>
										</select>
									</div>



								</div>

								<div class="row">
									<label class="col-sm-3 col-form-label"></label>
									<div class="col-sm-9">
										<div class="d-md-flex d-grid align-items-center gap-3">
											<button type="submit" class="btn btn-grd btn-grd-primary px-5">Save</button>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div><!-- end row -->

			<div class="card">
				<div class="card-body">
					<div class="table-responsive">
						<div id="example2_wrapper" class="dataTables_wrapper dt-bootstrap5">
							<div class="row">
								<div class="col-sm-12">
									<table id="example2"
										class="table table-striped table table-bordered mb-0 table-bordered dataTable"
										role="grid" aria-describedby="example2_info">
										<thead>
											<tr role="row">
												<th>Sr No</th>
												<th>Role</th>
												<th>Permission</th>
											</tr>
										</thead>
										<tbody>
											<!-- Loop through roles -->
											<tr th:each="role, iter : ${roles}" role="row">
												<td th:text="${iter.index + 1}"></td> <!-- Serial number -->
												<td th:text="${role.name}"></td> <!-- Role name -->

												<!-- Permissions with line breaks -->
												<td>
													<span th:each="permission : ${role.permissions}">
														<span th:text="${permission.name}"></span><br />
													</span>
												</td>
											</tr>
										</tbody>


										<tfoot>
										</tfoot>
									</table>
								</div>
							</div>
							<!-- Pagination and other elements can remain the same -->
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
</body>

<script src="assets/js/bootstrap.bundle.min.js"></script>

<!--plugins-->
<script src="assets/js/jquery.min.js"></script>
<!--plugins-->
<script src="assets/plugins/perfect-scrollbar/js/perfect-scrollbar.js"></script>
<script src="assets/plugins/metismenu/metisMenu.min.js"></script>
<script src="assets/plugins/datatable/js/jquery.dataTables.min.js"></script>
<script src="assets/plugins/datatable/js/dataTables.bootstrap5.min.js"></script>
<script>
	$(document).ready(function () {
		$('#example').DataTable();
	});
</script>
<script>
	$(document).ready(function () {
		var table = $('#example2').DataTable({
			lengthChange: false,
			buttons: ['copy', 'excel', 'pdf', 'print']
		});

		table.buttons().container()
			.appendTo('#example2_wrapper .col-md-6:eq(0)');
	});
</script>
<script src="assets/plugins/simplebar/js/simplebar.min.js"></script>
<script src="assets/js/main.js"></script>

</html>