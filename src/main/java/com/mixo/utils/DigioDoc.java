package com.mixo.utils;

import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.Base64;
import java.util.List;

public class DigioDoc {
	public static void main(String[] args) throws IOException, InterruptedException {
		String digio_url = "https://api.digio.in/v2/client/document/download?document_id=";
		String digio_token = "QUkyRVpTUUYxUUdHRDFMWE9DNkxaMUo5U1NQODhZTVM6UUoyNE1aS0M4OUpPWFBWU1YyR0lHQjhHNUxNMzdVOE8=";

		List<String> digioDocIds = List.of("DID250513122021531X3JBRAM1YMWLE5", "DID250522150430146TR7VBV2Q3T8QP1",
				"DID25052216125093777DW3QCNQ6J6WR", "DID250522174354630VLQL6ZLRLRVEBW",
				"DID250522175852620WXXHLJW6VK47R1", "DID2505221830492347AUSPLJL5P5O8G",
				"DID250526103659413ZV3UGQS37HNOUZ", "DID250526125319411LSLWFITRF86CAX",
				"DID250526130857187QGY8DH5C8EVUB8", "DID250526134739877L7N3GNZJ79RPHQ",
				"DID250526141147189Y5R3FU1R6UEH9B", "DID250526142742220WK8PAFSJ2MUKKR",
				"DID250526143604718WQ5DPV1ZKO9VQX", "DID250526144340104SMDLABJBVFUKZJ",
				"DID2505261509463806BZRFRA4HM9B4E", "DID250526152440555PA728RL64GMUWQ",
				"DID250526153853496E5CSBGYERJ6G6M", "DID25052615463948418IBRIH789Q66E",
				"DID250526155540331TCC5VE5NEMQHAM", "DID2505261602457751FMUYE9W53Q93T",
				"DID2505261609089718I82U79NKLYUH9", "DID250526161300696OGU8M5HKAGE9M3",
				"DID25052616193455313AFVOPQT64YUA", "DID250526162738640DOG19NVNHJSJFT",
				"DID250526162829978P5ZRAVQKC1WJMH", "DID250526163934903C5ODT6OFZJCUPJ",
				"DID2505261640393047CK7GQ6G6L764L", "DID250526164738052W5S9RO7NTRLDCL",
				"DID250526165257849JLNBK9F857ZW6R", "DID2505261655463907RMXL6SGXEW4VY",
				"DID2505261701100264AOBLB7ZC7BZ2R", "DID250526170340048O4L955BVFK7DOB",
				"DID250526170936377J2OYBJ5HZIFK6T", "DID250526171053076DZ94B4ZFP3PUCJ",
				"DID250526173902179EL5V3CY9HNC954", "DID250526175348053DUF2JOZLHBQ1MO",
				"DID250526180404694YI5GUFOBFRN5YZ", "DID250526182728228V47CZUBNLIGEH5",
				"DID250526190323655O7SKI4RLTJMYH4", "DID250526190655780CYJU98VNK3RTPU",
				"DID2505270919243732JMJG2RDS93FJA", "DID2505270959595842UFVHBCNP1GYPA",
				"DID2505271016550526TE1WOXQ7LPT1V", "DID250527105445906ZQIA2P2VML8LMZ",
				"DID250527105959772JYIGD1XR9YB26R", "DID250527111650796MJQCYIKIF1CI1M",
				"DID2505271157075305F63XP1IV6I8WN", "DID250527123548738S8HBBLZGRPOFWE",
				"DID250527125623302CK3U89QD5DDG2R", "DID250527154507321Z4V8X86Y6O5TTO",
				"DID250527160239815DEHM79JDEUSGBR", "DID250527161642015WWQJOJ5ABPZ1EL",
				"DID250527164030836S1WRASLVI9CFZ6", "DID250527165458593SEX8KS3EWAP4L4",
				"DID250527171128478CTMGAKDHTRODOB", "DID250527180448751V75NSOE7R3MP5M",
				"DID250527192432759QIHN3FKH92KQHA", "DID250528102140587S8Z7NNHJGLIX41",
				"DID250528103249261BESJGCMJDTMWZF", "DID250528104604012L7VFLEI18FGB3P",
				"DID250528110728199PA2KH4CVFREB7U", "DID250528112025093WZVNRW4G556O46",
				"DID2505281133326634X9LUE75RV8GTE", "DID250528124503341JOVIV4DT594WU2");

		HttpClient client = HttpClient.newHttpClient();

		for (String docId : digioDocIds) {
			String url = digio_url + docId;

			HttpRequest request = HttpRequest.newBuilder().uri(URI.create(url)).header("accept", "application/json")
					.header("content-type", "application/json").header("Authorization", "Basic " + digio_token).GET()
					.build();

			HttpResponse<byte[]> response = client.send(request, HttpResponse.BodyHandlers.ofByteArray());

			if (response.statusCode() == 200) {
				byte[] pdfBytes = response.body();

				// Optional: also get Base64 if needed
				String base64Pdf = Base64.getEncoder().encodeToString(pdfBytes);

				// Define the file path to save PDF
				Path filePath = Path.of("C:/GIG/" + docId + ".pdf"); // customize as needed

				Files.write(filePath, pdfBytes);

				System.out.println("PDF saved successfully at: " + filePath);
			} else {
				System.err.println(
						"Failed to download PDF for " + docId + ". HTTP Status Code: " + response.statusCode());
			}
		}
	}
}
